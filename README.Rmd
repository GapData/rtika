---
output: github_document
---
# rtika
***Extract text and metadata from over a thousand file types.***

[![Travis-CI Build Status](https://travis-ci.org/predict-r/rtika.svg?branch=master)](https://travis-ci.org/predict-r/rtika)

From Wikipedia: 

>Apache Tika is a content detection and analysis framework, written in Java, stewarded at the Apache Software Foundation. It detects and extracts metadata and text from over a thousand different file types, and as well as providing a Java library, has server and command-line editions suitable for use from other programming languages ...

>For most of the more common and popular formats, Tika then provides content extraction, metadata extraction and language identification capabilities. (Accessed Jan 18, 2018. See <https://en.wikipedia.org/wiki/Apache_Tika>.)

This R interface includes the Tika software.

## Installation
You need at least `Java 7` or `OpenJDK 1.7`. To check, run the command `java -version` from a terminal. Get Java installation tips at <http://openjdk.java.net/install/> or <https://www.java.com/en/download/help/download_options.xml>.

Next, install the `rtika` package from Github.com. 

```{r,results = "hide",message = FALSE }
# devtools simplifies installation from Github.
if(!requireNamespace('devtools')){ install.packages('devtools', repos='https://cloud.r-project.org') }
# Install rtika from github
if(!requireNamespace('rtika')){ devtools::install_github('predict-r/rtika') } 
library('rtika')
```



## Extract Plain Text
Get a text document, such as `.pdf`, `.doc`, `.docx`, `.rtf`, `.ppt`, or a mix. 
```{r,results = "hide",warning = FALSE}
input = 'https://cran.r-project.org/doc/manuals/r-release/R-data.pdf'
```

Extract the plain text with the `tika()` function. Relax, it will probably work! 
```{r,results = "hide",message = FALSE}
text = tika(input) # magic happens

```
The `text` will be a character vector, in the same order as `input`. Display a snippet using `cat`.  
```{r,comment=NA }
cat(substr(text[1],45,450)) # sub-string of the text

```
## Get Metadata
Metadata comes with the `json`,`xml` and `html` output options. A side effect is that Tika retains more document structure, like table cells.
```{r,results = "hide",warning = FALSE,message = FALSE}
library('jsonlite')
json = tika(input,'J') # 'J' is a shortcut for 'jsonRecursive'
metadata = fromJSON(json[1])
```
See the structure of the metadata, or meta-metadata ðŸ¤¯ .

```{r,comment=NA}
str(metadata) #data.frame of metadata
```
```{r,echo=FALSE}
# unlink(dinput_ir,recursive = TRUE)
```
## Similar Packages

In March 2012, I created a repository on `r-forge` called `r-tika` (See: <https://r-forge.r-project.org/projects/r-tika/>) to interface with Apache Tika (See: <https://tika.apache.org/>). While no code was publicly released, my initial code-base used low-level functions from the `rJava` package to interface with the Tika library. I halted development after discovering that the Tika command line interface (CLI) served my purposes. 

In September 2017, user *kyusque* released `tikaR`, which uses the `rJava` package to interact with Tika (See: <https://github.com/kyusque/tikaR>). As of writing, it provided a `xml` parser and metadata extraction. 

With  `rtika`, I chose to interface with the Tika CLI and its 'batch processor' tool. Much of the batch processor is implemented in Tika 1.17 (See: <https://wiki.apache.org/tika/TikaBatchOverview>). The Tika batch processor has good efficiency when processing tens of thousands of documents, is not too slow for a single document, and handles errors gracefully. Further, connecting `R` to the Tika CLI batch processor is relatively easy to maintain, because the `R` code is simple. I anticipate that various researchers will need plain text output, while others want json output. These are implemented in the CLI and hence in `rtika` (although apparently not in `tikaR`). Multiple threads are supported in both the CLI and `rtika`. The `rtika` package anticipates future features with the `args` attribute of the `tika` function, that allows access to the Tika CLI. Another motivation was that `rJava` hwasonce bifficult to get working on Ubuntu and CentOS, especially around wthe time hen Java was not open sourced, although that probably ihas improved
